<div  id="map" name="<%= @location_array %>">
</div>
<% @store_names_display.each_with_index do |store, index| %>
  <h3><%= @alphabet[index]%>. <%= store %> </h3>
  <p><%= @store_addresses[index] %></p>
<% end %>
  <h3></h3>
    <div id="store-names", name="<%= @store_names %>">
    </div>
    <div id="store-lats", name="<%= @store_lats %>">
    </div>
     <div id="store-lngs", name="<%= @store_lngs %>">
    </div>
    <div id="store-addresses", name="<%= @store_addresses %>">
    </div>


    <script type="text/javascript">
    String.prototype.insertAt=function(index, string) {
  return this.substr(0, index) + string + this.substr(index);
      }
      var map;
      var coordinates = $("#map").attr('name');
      var array = coordinates.split(",");
      var lat = array[0].slice(1)
      var lng = array[1].slice(0)
      lng = lng.slice(1,(lng.length - 1))
      lat = parseFloat(lat);
      lng = parseFloat(lng);

      var storeNames = $("#store-names").attr('name');
      var storeNames = storeNames.slice(0)
      var storeNames = storeNames.slice(1, (storeNames.length - 1))
      storeNames = storeNames.split(",")

      var storeLats = $("#store-lats").attr('name');
      var storeLats = storeLats.slice(0)
      var storeLats = storeLats.slice(1, (storeLats.length - 1))
      storeLats = storeLats.split(",")

      var storeLngs = $("#store-lngs").attr('name');
      var storeLngs = storeLngs.slice(0)
      var storeLngs = storeLngs.slice(1, (storeLngs.length - 1))
      storeLngs = storeLngs.split(",")

      for(var i = 0; i < storeLats.length; i++) {
        storeLats[i] = parseFloat(storeLats[i])
         storeLngs[i] = parseFloat(storeLngs[i])
      }
      console.log(storeLats)

      var storeAddresses = $("#store-addresses").attr('name');
      var storeAddresses = storeAddresses.slice(0)
      var storeAddresses = storeAddresses.slice(1, (storeAddresses.length - 1))
      storeAddresses = storeAddresses.split(",")
      addressesArray = []
      for(var i = 0; i < storeAddresses.length - 1; i+=2) {
        addressesArray.push(storeAddresses[i] + ", " + storeAddresses[i+1])
      }



//"https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=" + lat + "," + lng + "&radius=500&keyword=pet&key=AIzaSyCX0zgiH5c-ezhGHS679V2hWO7rQbenKbg"

      //  $.ajax({
      //   method: "POST",
      //   dataType: 'json',
      //   useDefaultXhrHeader: false,
      //   url: "https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=" + lat + "," + lng + "&radius=5000&keyword=pet&types=pet_store&key=AIzaSyCX0zgiH5c-ezhGHS679V2hWO7rQbenKbg",
      //   success: function(response){
      //     console.log(response[0])
      //   }
      // })

    // var store1 = $("#store1").attr('name');
    // var store1Name = $("#store1-name").attr('name');
    // store1 = store1.split(",");

    // var store1Lat = store1[0].slice(1);
    //  var store1Lng = store1[1].slice(1, (store1[1].length - 1));
    //  store1Lat = parseFloat(store1Lat);
    //  store1Lng = parseFloat(store1Lng);


function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: lat, lng: lng},
    zoom: 14
  });

  // var marker = new google.maps.Marker({
  //   map: map,
  //   position: {lat: lat, lng: lng},
  //   title: 'Hello World!'
  // });
    var cityCircle = new google.maps.Circle({
      strokeColor: '#FF0000',
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillColor: '#FF0000',
      fillOpacity: 0.35,
      map: map,
      center: {lat: lat, lng: lng},
      radius: 40
    });


    var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var labelIndex = 0;
   var markers = []
   markers.length = storeNames.length
   var contentString = []
   contentString.length = storeNames.length
   console.log(markers.length)
   for(var i = 0; i < storeNames.length; i++) {
      markers[i] = new google.maps.Marker({
    map: map,
    position: {lat: storeLats[i], lng: storeLngs[i]},
    label: labels[labelIndex++ % labels.length],
    title: storeNames[i]
  });
       }
  //      for (var i = 0; i < storeNames.length; i++) {
  //       markers[i].addListener('click', function() {
  //   infowindow.open(map, markers[i]);
  // });
  //   contentString[i] = '<h5 id="firstHeading" class="firstHeading">' + storeNames[i] + '</h5>' + '<p>' + storeAddresses[i] +'</p>'

  //      }

  //      for(var i = 0; i < storeNames.length; i++) {
  //       var infowindow = new google.maps.InfoWindow({
  //   content: contentString[i]
  // });
  //      }
      // console.log(markers[0])



  // var firstMarker = new google.maps.Marker({
  //   map: map,
  //   position: {lat: store1Lat, lng: store1Lng},
  //   title: store1Name
  // });

  //    var secondMarker = new google.maps.Marker({
  //   map: map,
  //   position: {lat: store2Lat, lng: store2Lng},
  //   title: store1Name
  // });
  //   secondMarker.addListener('click', function() {
  //   infowindow.open(map, secondMarker);
  // });

  //    var thirdMarker = new google.maps.Marker({
  //   map: map,
  //   position: {lat: store3Lat, lng: store3Lng},
  //   title: store1Name
  // });
  //   thirdMarker.addListener('click', function() {
  //   infowindow.open(map, thirdMarker);
  // });
}


    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCxHSsHvEIld84HHYj5nvetfW6cV7gYNAs&callback=initMap">
    </script>
